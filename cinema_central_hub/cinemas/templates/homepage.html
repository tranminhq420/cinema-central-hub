{% extends 'base.html' %}
{% load static %}

{% block title %}Home - Cinema Central Hub{% endblock %}

{% block content %}
<!-- Simple Slider -->
<div class="simple-slider">
    <div class="slider-container">
        <div class="slide">
            <img src="https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80" alt="Movie Theater">
            <div class="slide-content">
                <h2 class="slide-title">Discover Amazing Movies</h2>
                <p class="slide-description">Experience the magic of cinema with our latest releases</p>
            </div>
        </div>
        <div class="slide">
            <img src="https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80" alt="Premium Cinema">
            <div class="slide-content">
                <h2 class="slide-title">Premium Experience</h2>
                <p class="slide-description">Enjoy movies in ultimate comfort and quality</p>
            </div>
        </div>
        <div class="slide">
            <img src="https://images.unsplash.com/photo-1536440136628-849c177e76a1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80" alt="Movie Experience">
            <div class="slide-content">
                <h2 class="slide-title">Book Your Tickets</h2>
                <p class="slide-description">Reserve the best seats for your favorite movies</p>
            </div>
        </div>
    </div>

    <div class="slider-nav">
        <div class="slider-dot active" data-slide="0"></div>
        <div class="slider-dot" data-slide="1"></div>
        <div class="slider-dot" data-slide="2"></div>
    </div>

    <div class="slider-arrows">
        <div class="slider-arrow" id="prevSlide">‚Üê</div>
        <div class="slider-arrow" id="nextSlide">‚Üí</div>
    </div>
</div>

<!-- Now Showing Section -->
<div class="section-header">
    <h2 class="section-title">Now Showing</h2>
    <p class="section-description">Discover the latest blockbusters and must-see films currently playing in our theaters.</p>
</div>

<div class="category-tabs">
    <div class="category-tab active">All</div>
    <div class="category-tab">Action</div>
    <div class="category-tab">Drama</div>
    <div class="category-tab">Comedy</div>
    <div class="category-tab">Horror</div>
</div>

  <div class="movie-container">
    {% if films %}
    <div class="movie-grid">
    {% for movie in films %}
        <div class="movie-card">
            <div class="movie-poster-wrapper">
              {% if movie.image_url %}
                <img src="{{ movie.image_url }}" alt="{{ movie.title }}" class="movie-poster">
              {% else %}
                <div class="movie-poster" style="background: var(--bg-light); display: flex; align-items: center; justify-content: center;">
                    <span style="color: var(--text-light); font-size: 1.5rem;">üé¨</span>
              </div>
              {% endif %}
                
                <div class="movie-overlay"></div>

              {% if movie.age_limit %}
                <div class="movie-age-rating">
                  {{ movie.age_limit }}
              </div>
              {% endif %}

                {% if movie.price %}
                <div class="movie-rating">
                    <span>üí∞</span>
                    {{ movie.price }}
                </div>
                {% endif %}
          </div>

          <div class="movie-content">
                <h3 class="movie-title">{{ movie.title }}</h3>

                <div class="movie-meta">
              {% if movie.genre %}
                    <span class="movie-tag genre">{{ movie.genre }}</span>
                    {% endif %}
                    
                    {% if movie.movie_type %}
                    <span class="movie-tag">{{ movie.movie_type }}</span>
              {% endif %}

                    {% if movie.format %}
                    <span class="movie-tag format">{{ movie.format }}</span>
                    {% endif %}
                </div>

                <div class="movie-actions">
              {% if movie.slug %}
                    <a href="{% url 'movie_detail' movie.slug %}" class="movie-btn movie-btn-primary">
                        <span>üé¨</span> View Details
                </a>
                    {% if movie.booking_url %}
                    <a href="{{ movie.booking_url }}" target="_blank" class="movie-btn movie-btn-secondary">
                        <span>üéüÔ∏è</span> Book
                    </a>
                    {% endif %}
              {% else %}
                    <span class="movie-btn" style="background: var(--text-light); color: var(--bg-white); cursor: not-allowed;">
                        Not Available
                </span>
              {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
    </div>
    {% else %}
    <div class="text-center" style="padding: var(--spacing-xl) 0;">
        <div style="font-size: 4rem; margin-bottom: var(--spacing-md);">üé¨</div>
        <h2 style="font-size: 1.5rem; color: var(--text-primary); margin-bottom: var(--spacing-md);">
            No movies available at the moment
        </h2>
        <p style="color: var(--text-secondary);">
            Please check back later for new releases.
        </p>
    </div>
    {% endif %}
</div>

<!-- Featured Movie Section -->
{% if films.first %}
<div class="featured-section">
    <div class="container">
        <div class="featured-grid">
            <div class="featured-content">
                <h2 class="featured-title">Featured: {{ films.first.title }}</h2>
                <p class="featured-description">{{ films.first.description|truncatewords:50 }}</p>
                <div class="movie-actions">
                    {% if films.first.slug %}
                    <a href="{% url 'movie_detail' films.first.slug %}" class="movie-btn movie-btn-primary">
                        <span>üé¨</span> Learn More
                    </a>
                    {% endif %}
                    {% if films.first.booking_url %}
                    <a href="{{ films.first.booking_url }}" target="_blank" class="movie-btn movie-btn-secondary">
                        <span>üéüÔ∏è</span> Get Tickets
                    </a>
                    {% endif %}
                </div>
            </div>
            <div class="featured-image">
                {% if films.first.image_url %}
                <img src="{{ films.first.image_url }}" alt="{{ films.first.title }}">
                {% endif %}
            </div>
        </div>
    </div>
    </div>
  {% endif %}

<!-- Coming Soon Section -->
<div class="section-header">
    <h2 class="section-title">Coming Soon</h2>
    <p class="section-description">Get a sneak peek at upcoming releases and be the first to book tickets.</p>
</div>

<div class="coming-soon-slider">
    <div class="coming-soon-track">
        {% for movie in films|slice:":5" %}
        <div class="coming-soon-card">
            <div class="movie-card">
                <div class="movie-poster-wrapper">
                    {% if movie.image_url %}
                    <img src="{{ movie.image_url }}" alt="{{ movie.title }}" class="movie-poster">
                    {% endif %}
                    <div class="movie-overlay"></div>
                </div>
                <div class="movie-content">
                    <h3 class="movie-title">{{ movie.title }}</h3>
                    <div class="movie-meta">
                        {% if movie.genre %}
                        <span class="movie-tag genre">{{ movie.genre }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
  </div>
  
<!-- Newsletter Section -->
<div class="newsletter-section">
    <div class="container">
        <div class="newsletter-content">
            <h2 class="newsletter-title">Stay Updated</h2>
            <p class="newsletter-description">Subscribe to our newsletter for exclusive movie updates, special offers, and more!</p>
            <form class="newsletter-form">
                <input type="email" class="newsletter-input" placeholder="Enter your email address">
                <button type="submit" class="newsletter-button">Subscribe</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const slider = document.querySelector('.slider-container');
    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.slider-dot');
    const prevButton = document.querySelector('#prevSlide');
    const nextButton = document.querySelector('#nextSlide');
    let currentSlide = 0;
    const slideCount = slides.length;
    const slideInterval = 5000; // 5 seconds

    function updateSlider() {
        slider.style.transform = `translateX(-${currentSlide * 33.333}%)`;
        dots.forEach(dot => dot.classList.remove('active'));
        dots[currentSlide].classList.add('active');
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % slideCount;
        updateSlider();
    }

    function prevSlide() {
        currentSlide = (currentSlide - 1 + slideCount) % slideCount;
        updateSlider();
    }

    // Event Listeners
    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            currentSlide = index;
            updateSlider();
        });
    });

    prevButton.addEventListener('click', prevSlide);
    nextButton.addEventListener('click', nextSlide);

    // Auto advance slides
    setInterval(nextSlide, slideInterval);
});
</script>
{% endblock %}